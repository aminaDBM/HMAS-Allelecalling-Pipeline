## HMAS-Allelecalling Pipeline

* [Preparation](#preparation)
* [Execution](#execution)
* [Updating Centroid Reference Database](#updating-centroid-reference-database)


### Preparation
Allele calling pipeline requires the following pre-requisites:

* **Predicted primers database**

A set of insilico designed primer sequences is selected as a training set. This set of sequences in fasta format is run through the following command to create a database for sorting *Input sequences* into *Known Alleles* and *Unknown Alleles*.

      makeblastdb -in BLAST1fasta -title BLAST1_DB -dbtype nucl -out /path to save/BLAST1_DB


* **Centroid reference fasta file**

Centroid reference fasta file is a set of sequences generated by following the centroid reference generation protocol explained [here](https://github.com/aminaDBM/HMAS-Allelecalling-Pipeline/tree/main/Centroid_Reference)

![Screenshot (36)](https://user-images.githubusercontent.com/93733968/229141962-557080e5-5a3f-4e36-9e42-282c03b69fa5.png)
* **Centroid Reference database**

Centroid reference fasta file is utilized to construct the *Centroid_Reference database* . The set of centroid reference sequences in fasta format is run through the following command:

            makeblastdb -in BLAST2fasta -title BLAST2_DB -dbtype nucl -out /path to save/BLAST2_DB

Centroid reference database helps sort the *Unknown alleles* into *Novel alleles* and *Not found alleles*.


### Execution

The pipeline comprises of two R scripts and a bash script kept in the same path. The bash script requires the user to specify paths to input data, Insilico primers database and centroid reference database. 
The pipeline can be initiated using the following command:

      bash Allelecalling.sh
  

### Updating Centroid Reference Database

* The centroid reference databse can be updated by adding the novel alleles sequences to the fasta file for centroid reference. The update file can be processed through the steps mentioned [here](#database-setup)
      
       

![Screenshot (35)](https://user-images.githubusercontent.com/93733968/229220687-0d411e08-8faf-4016-8f9a-9a3ffdc74c15.png)

